{"version":3,"sources":["components/BookStoreServiceContext/BookStoreServiceContext.js","services/bookstore-service.js","components/Cart/index.js","components/Cart/Cart.js","components/Header/index.js","components/Header/Header.js","actions/index.js","components/Table/Table.js","components/Table/index.js","components/Pages/CartPage.js","utils/compose.js","components/Hoc/withBookStoreService.js","components/BookCard/index.js","components/BookCard/BookCard.js","components/Spinner/index.js","components/Spinner/Spinner.js","components/ErrorIndicator/index.js","components/ErrorIndicator/ErrorIndicator.js","components/BookCardList/BookCardList.js","components/BookCardList/index.js","components/Pages/HomePage.js","components/App/index.js","components/App/App.js","components/ErrorBoundry/index.js","components/ErrorBoundry/ErrorBoundry.js","reducers/index.js","store.js","index.js"],"names":["React","createContext","BookStoreServiceProvider","Provider","BookStoreServiceConsumer","Consumer","BookStoreService","defaultData","id","title","author","price","total","count","image","Promise","resolve","setTimeout","Cart","connect","state","cartBooks","length","reduce","a","value","className","to","Header","bookAddedToCart","bookId","type","payload","fetchBooks","dispatch","bookStoreService","getBooks","then","response","catch","Table","columns","data","TableContainer","books","onAddedBook","onRemovedBook","onDeletedBook","props","config","useState","sortConfig","setSortConfig","sortedData","useMemo","sort","b","field","direction","requestSort","useSortableTable","name","label","map","item","index","scope","onClick","role","aria-label","CartPage","Fragment","compose","func","component","reduceRight","previousValue","f","withBookStoreService","WrappedComponent","BookCard","book","src","alt","style","maxHeight","maxWidth","marginTop","Spinner","ErrorIndicator","BookCardList","loading","error","ownProps","useEffect","HomePage","App","path","exact","ErrorBoundry","hasError","info","this","setState","children","Component","defaultState","updateCartItems","slice","updateOrder","quantity","find","cartItemIdx","findIndex","newItem","updateCartItem","reducer","cartItem","store","createStore","applyMiddleware","thunk","reduxLogger","window","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.d69cbcd3.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst {\r\n  Provider: BookStoreServiceProvider,\r\n  Consumer: BookStoreServiceConsumer,\r\n} = React.createContext();\r\n\r\nexport { BookStoreServiceProvider, BookStoreServiceConsumer };\r\n","export default class BookStoreService {\r\n  defaultData = [\r\n    {\r\n      id: 1,\r\n      title: 'JavaScript. Detailed guide',\r\n      author: 'David Flanagan',\r\n      price: 3500,\r\n      total: 3500,\r\n      count: 1,\r\n      image: '../img/book1.jpg',\r\n    },\r\n    {\r\n      id: 2,\r\n      title: 'Client-Server Web Apps with JavaScript and Java',\r\n      author: 'Casimir Saternos',\r\n      price: 3200,\r\n      total: 3200,\r\n      count: 1,\r\n      image: '../img/book2.jpg',\r\n    },\r\n  ];\r\n\r\n  getBooks() {\r\n    return new Promise(resolve => setTimeout(resolve(this.defaultData), 700));\r\n  }\r\n}\r\n","import Cart from './Cart';\r\n\r\nexport default Cart;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport './Cart.css';\r\n\r\nconst Cart = ({ cartBooks }) => {\r\n  let count = 0;\r\n  let total = 0;\r\n\r\n  if (cartBooks.length !== 0) {\r\n    count = cartBooks.reduce((a, value) => a + value.count, 0);\r\n    total = cartBooks.reduce((a, value) => a + value.total, 0);\r\n  }\r\n\r\n  return (\r\n    <div className=\"cart\">\r\n      <Link to=\"/cart\" className=\"cart-icon\">\r\n        <i className=\"fa fa-cart-plus\"></i>\r\n      </Link>\r\n      <span className=\"cart-status\">\r\n        {count} items ({total} RUB)\r\n      </span>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = state => ({ cartBooks: state.cartBooks });\r\n\r\nCart.propTypes = {\r\n  cartBooks: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n};\r\n\r\nexport default connect(mapStateToProps)(Cart);\r\n","import Header from './Header';\r\n\r\nexport default Header;\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Cart from '../Cart';\r\nimport './Header.css';\r\n\r\nconst Header = () => (\r\n  <div className=\"header\">\r\n    <h1 className=\"logo\">\r\n      <Link to=\"/\">Restore</Link>\r\n    </h1>\r\n    <Cart />\r\n  </div>\r\n);\r\n\r\nexport default Header;\r\n","// action в случае успешного сетевого запроса\r\nconst booksLoaded = newBooks => ({\r\n  type: 'FETCH_BOOKS_SUCCESS',\r\n  payload: newBooks,\r\n});\r\n\r\n// action для получения данных с сервера\r\nconst booksRequested = () => ({\r\n  type: 'FETCH_BOOKS_REQUEST',\r\n});\r\n\r\n// action в случае ошибки при выполнении сетевого запроса\r\nconst booksError = () => ({\r\n  type: 'FETCH_BOOKS_FAILURE',\r\n});\r\n\r\n// action для добавления экзмепляра книги в корзину\r\nconst bookAddedToCart = bookId => ({\r\n  type: 'BOOK_ADDED_TO_CART',\r\n  payload: bookId,\r\n});\r\n\r\n// action для удаления экзмепляра книги из корзины\r\nconst bookRemovedFromCart = bookId => ({\r\n  type: 'BOOK_REMOVED_FROM_CART',\r\n  payload: bookId,\r\n});\r\n\r\n// action для полного удаления всех экзмепляров книги из корзины\r\nconst bookDeleted = bookId => ({\r\n  type: 'ALL_BOOK_REMOVED_FROM_CART',\r\n  payload: bookId,\r\n});\r\n\r\n// quasi-action для выделения универсальной, часто используемой логики\r\nconst fetchBooks = (dispatch, bookStoreService) => () => {\r\n  dispatch(booksRequested());\r\n  bookStoreService\r\n    .getBooks() // получение данных\r\n    .then(response => dispatch(booksLoaded(response))) // обновление state.books и state.loading\r\n    .catch(() => dispatch(booksError())); // обновление state.books и state.error\r\n};\r\n\r\nexport { fetchBooks, bookAddedToCart, bookRemovedFromCart, bookDeleted };\r\n","import React, { useState, useMemo } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {\r\n  bookAddedToCart,\r\n  bookRemovedFromCart,\r\n  bookDeleted,\r\n} from '../../actions';\r\nimport PropTypes from 'prop-types';\r\nimport './Table.css';\r\n\r\n// функциональность сортировки данных в таблице\r\nconst useSortableTable = (data, config = null) => {\r\n  const [sortConfig, setSortConfig] = useState(config);\r\n\r\n  const sortedData = useMemo(() => {\r\n    if (sortConfig !== null) {\r\n      data.sort((a, b) => {\r\n        if (a[sortConfig.field] < b[sortConfig.field]) {\r\n          return sortConfig.direction === 'asc' ? -1 : 1;\r\n        }\r\n        if (a[sortConfig.field] > b[sortConfig.field]) {\r\n          return sortConfig.direction === 'asc' ? 1 : -1;\r\n        }\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    return data;\r\n  }, [data, sortConfig]);\r\n\r\n  const requestSort = field => {\r\n    let direction = 'asc';\r\n    if (sortConfig && sortConfig.direction === 'asc') {\r\n      direction = 'desc';\r\n    }\r\n    setSortConfig({ field, direction });\r\n  };\r\n\r\n  return { sortedData, requestSort };\r\n};\r\n\r\n// настройка таблицы и логика рендера\r\nconst TableContainer = props => {\r\n  const { books, onAddedBook, onRemovedBook, onDeletedBook } = props;\r\n  const { sortedData, requestSort } = useSortableTable(books);\r\n\r\n  const columnProperties = [\r\n    { name: 'id', label: '#' },\r\n    { name: 'title', label: 'Title' },\r\n    { name: 'count', label: 'Count' },\r\n    { name: 'price', label: 'Total' },\r\n    { name: 'action', label: 'Action' },\r\n  ];\r\n\r\n  const columns = columnProperties.map((item, index) => {\r\n    const { name, label } = item;\r\n    const columnClassName = 'btn btn-primary';\r\n    return (\r\n      <th key={index} scope=\"col\">\r\n        <button className={columnClassName} onClick={() => requestSort(name)}>\r\n          {label}\r\n        </button>\r\n      </th>\r\n    );\r\n  });\r\n\r\n  const data = sortedData.map((item, index) => {\r\n    const { id, title, count, total } = item;\r\n    return (\r\n      <tr key={index}>\r\n        <th scope=\"row\">{id}</th>\r\n        <td>{title}</td>\r\n        <td>{count}</td>\r\n        <td>{total}</td>\r\n        <td>\r\n          <div className=\"btn-group\" role=\"group\" aria-label=\"Buttons\">\r\n            <button\r\n              className=\"btn btn-outline-success\"\r\n              onClick={() => onAddedBook(id)}\r\n            >\r\n              <i className=\"fa fa-plus\"></i>\r\n            </button>\r\n            <button\r\n              className=\"btn btn-outline-warning\"\r\n              onClick={() => onRemovedBook(id)}\r\n            >\r\n              <i className=\"fa fa-minus\"></i>\r\n            </button>\r\n            <button\r\n              className=\"btn btn-outline-danger\"\r\n              onClick={() => onDeletedBook(id)}\r\n            >\r\n              <i className=\"fa fa-trash-o\"></i>\r\n            </button>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    );\r\n  });\r\n\r\n  return <Table columns={columns} data={data} />;\r\n};\r\n\r\nconst Table = ({ columns, data }) => (\r\n  <div className=\"shopping-table\">\r\n    <h2 className=\"table-title\">Your Order</h2>\r\n    <table className=\"table table-bordered border-primary\">\r\n      <thead>\r\n        <tr className=\"table-primary\">{columns}</tr>\r\n      </thead>\r\n      <tbody>{data}</tbody>\r\n    </table>\r\n  </div>\r\n);\r\n\r\nconst mapStateToProps = state => ({ books: state.cartBooks });\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onAddedBook: id => dispatch(bookAddedToCart(id)),\r\n  onRemovedBook: id => dispatch(bookRemovedFromCart(id)),\r\n  onDeletedBook: id => dispatch(bookDeleted(id)),\r\n});\r\n\r\nTableContainer.propTypes = {\r\n  books: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n  onAddedBook: PropTypes.func.isRequired,\r\n  onRemovedBook: PropTypes.func.isRequired,\r\n  onDeletedBook: PropTypes.func.isRequired,\r\n};\r\n\r\nTable.propTypes = {\r\n  columns: PropTypes.array.isRequired,\r\n  data: PropTypes.array.isRequired,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TableContainer);\r\n","import TableContainer from './Table';\r\n\r\nexport default TableContainer;\r\n","import React from 'react';\r\nimport Header from '../Header';\r\nimport TableContainer from '../Table';\r\n\r\nconst CartPage = () => (\r\n  <React.Fragment>\r\n    <Header />\r\n    <TableContainer />\r\n  </React.Fragment>\r\n);\r\n\r\nexport default CartPage;\r\n","const compose = (...func) => component =>\r\n  func.reduceRight((previousValue, f) => f(previousValue), component);\r\n\r\nexport default compose;\r\n","import React from 'react';\r\nimport { BookStoreServiceConsumer } from '../BookStoreServiceContext';\r\n\r\nconst withBookStoreService = () => WrappedComponent =>\r\n  function consumerWrapper(props) {\r\n    return (\r\n      <BookStoreServiceConsumer>\r\n        {bookStoreService => (\r\n          <WrappedComponent {...props} bookStoreService={bookStoreService} />\r\n        )}\r\n      </BookStoreServiceConsumer>\r\n    );\r\n  };\r\n\r\nexport default withBookStoreService;\r\n","import BookCard from './BookCard';\r\n\r\nexport default BookCard;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport './BookCard.css';\r\n\r\nconst BookCard = ({ book, onAddedBook }) => {\r\n  const { id, title, author, price, image } = book;\r\n  return (\r\n    <div className=\"card text-dark bg-light border-dark mb-3\">\r\n      <div className=\"card-header\">{title}</div>\r\n      <img\r\n        src={image}\r\n        className=\"card-img-top\"\r\n        alt=\"Book Image\"\r\n        style={{ maxHeight: '700px', maxWidth: '538px' }}\r\n      ></img>\r\n      <div className=\"card-body\">\r\n        <h5 className=\"card-title\">{title}</h5>\r\n        <h5 className=\"card-subtitle mb-2 text-muted\">{author}</h5>\r\n        <h3 className=\"card-text\">{price} RUB</h3>\r\n        <button\r\n          className=\"btn btn-success btn-lg\"\r\n          style={{ marginTop: '20px' }}\r\n          onClick={() => onAddedBook(id)}\r\n        >\r\n          Add to Cart\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nBookCard.propTypes = {\r\n  book: PropTypes.object.isRequired,\r\n  onAddedBook: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default BookCard;\r\n","import Spinner from './Spinner';\r\n\r\nexport default Spinner;\r\n","import React from 'react';\r\nimport './Spinner.css';\r\n\r\nconst Spinner = () => (\r\n  <div className=\"loading-indicator\">\r\n    <div className=\"loadingio-spinner-double-ring-quh3a49vtmd\">\r\n      <div className=\"ldio-9opildb5qm5\">\r\n        <div></div>\r\n        <div></div>\r\n        <div>\r\n          <div></div>\r\n        </div>\r\n        <div>\r\n          <div></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default Spinner;\r\n","import ErrorIndicator from './ErrorIndicator';\r\n\r\nexport default ErrorIndicator;\r\n","import React from 'react';\r\n\r\nimport './ErrorIndicator.css';\r\n\r\nconst ErrorIndicator = () => (\r\n  <div className=\"error-indicator\">\r\n    <div className=\"loadingio-spinner-magnify-xvi2eomm9dk\">\r\n      <div className=\"ldio-djr5te9pz2p\">\r\n        <div>\r\n          <div>\r\n            <div></div>\r\n            <div></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <span className=\"error-message\">\r\n      <div>Something has gone wrong!</div>\r\n    </span>\r\n  </div>\r\n);\r\n\r\nexport default ErrorIndicator;\r\n","import React, { useEffect } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux';\r\nimport { compose } from '../../utils';\r\nimport { withBookStoreService } from '../Hoc';\r\nimport { fetchBooks, bookAddedToCart } from '../../actions';\r\nimport BookCard from '../BookCard';\r\nimport Spinner from '../Spinner';\r\nimport ErrorIndicator from '../ErrorIndicator';\r\n\r\nconst BookCardListContainer = props => {\r\n  const { books, loading, error, fetchBooks, bookAddedToCart } = props;\r\n\r\n  useEffect(() => fetchBooks(), [fetchBooks]);\r\n\r\n  if (loading) return <Spinner />;\r\n  if (error) return <ErrorIndicator />;\r\n\r\n  return <BookCardList books={books} onAddedBook={bookAddedToCart} />;\r\n};\r\n\r\nconst BookCardList = ({ books, onAddedBook }) => (\r\n  <div className=\"row\">\r\n    {books.map(book => (\r\n      <div key={book.id} className=\"col-sm-6\">\r\n        <BookCard book={book} onAddedBook={onAddedBook} />\r\n      </div>\r\n    ))}\r\n  </div>\r\n);\r\n\r\n// принимаем state из store и возвращаем {prop: state.key}\r\n// для передачи state в компонент в качестве props\r\nconst mapStateToProps = state => ({\r\n  books: state.books,\r\n  loading: state.loading,\r\n  error: state.error,\r\n});\r\n\r\n// mapDispatchToProps может быть функцией или объектом\r\n// если функция, то она обязательно принимает dispatch\r\n// возвращает объект {prop: (newData) => dispatch(action)} для передачи dispatched prop в компонент\r\n// если объект, то это объект с action creator, action creator автоматически передается в bindActionCreator()\r\n// и возвращает объект {prop: (newData) => dispatch(action)}, где prop это booksLoaded\r\nconst mapDispatchToProps = (dispatch, ownProps) => {\r\n  // ownProps нужен, чтобы получить доступ к свойству, приходящему из HOC withBookStoreService()\r\n  const { bookStoreService } = ownProps;\r\n  return {\r\n    fetchBooks: fetchBooks(dispatch, bookStoreService),\r\n    bookAddedToCart: id => dispatch(bookAddedToCart(id)),\r\n  };\r\n};\r\n\r\nBookCardListContainer.propTypes = {\r\n  books: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n  loading: PropTypes.bool.isRequired,\r\n  error: PropTypes.bool.isRequired,\r\n  fetchBooks: PropTypes.func.isRequired,\r\n  bookAddedToCart: PropTypes.func.isRequired,\r\n};\r\n\r\nBookCardList.propTypes = {\r\n  books: PropTypes.arrayOf(PropTypes.object).isRequired,\r\n  onAddedBook: PropTypes.func.isRequired,\r\n};\r\n\r\n// BookCardList обрачивается сначала connect(), потом withBookStoreService()\r\n// withBookStoreService()(connect(mapStateToProps, mapDispatchToProps)(BookCardList))\r\n// compose() позволяет упростить запись\r\nexport default compose(\r\n  withBookStoreService(),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(BookCardListContainer);\r\n","import BookCardList from './BookCardList';\r\n\r\nexport default BookCardList;\r\n","import React from 'react';\r\nimport Header from '../Header';\r\nimport BookCardList from '../BookCardList';\r\nimport TableContainer from '../Table';\r\n\r\nconst HomePage = () => (\r\n  <React.Fragment>\r\n    <Header />\r\n    <BookCardList />\r\n    <TableContainer />\r\n  </React.Fragment>\r\n);\r\n\r\nexport default HomePage;\r\n","import App from './App';\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport { CartPage, HomePage } from '../Pages';\r\n\r\nconst App = () => (\r\n  <React.Fragment>\r\n    <Switch>\r\n      <Route path=\"/\" exact={true} component={HomePage} />\r\n      <Route path=\"/cart\" component={CartPage} />\r\n    </Switch>\r\n  </React.Fragment>\r\n);\r\n\r\nexport default App;\r\n","import ErrorBoundry from './ErrorBoundry';\r\n\r\nexport default ErrorBoundry;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ErrorIndicator from '../ErrorIndicator';\r\n\r\nexport default class ErrorBoundry extends Component {\r\n  state = {\r\n    hasError: false,\r\n  };\r\n\r\n  // аргументы error и info позволяют делать отладку в браузере\r\n  // включаем debugger, далее см. Scope -> Local в браузере\r\n  /*eslint-disable no-unused-vars*/\r\n  componentDidCatch(error, info) {\r\n    this.setState({ hasError: true });\r\n  }\r\n\r\n  render() {\r\n    const { hasError } = this.state;\r\n    if (hasError) return <ErrorIndicator />;\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nErrorBoundry.propTypes = {\r\n  children: PropTypes.object.isRequired,\r\n};\r\n","const defaultState = {\r\n  books: [], // исходные данные\r\n  cartBooks: [], // заказанные книги\r\n  loading: true,\r\n  error: false,\r\n};\r\n\r\n// добавление/удаление экземпляра(-ов) книги\r\nconst updateCartItems = (cartBooks, item, index) => {\r\n  // если в заказе еще нет выбранной книги, добавляем новую книгу к заказу\r\n  if (index === -1) {\r\n    return [...cartBooks, item];\r\n  }\r\n  // если количество экземпляров книги = 0, удаляем книгу из заказа\r\n  if (item.count === 0) {\r\n    return [...cartBooks.slice(0, index), ...cartBooks.slice(index + 1)];\r\n  }\r\n  // иначе обновляем заказ, добавляя новый экземпляр книги\r\n  return [...cartBooks.slice(0, index), item, ...cartBooks.slice(index + 1)];\r\n};\r\n\r\n// создание нового объекта (книги) для обновления state (cartBooks)\r\nconst updateCartItem = (book, item = {}, quantity) => {\r\n  const { total = 0, count = 0 } = item;\r\n  return {\r\n    ...book,\r\n    total: total + quantity * book.price,\r\n    count: count + quantity,\r\n  };\r\n};\r\n\r\n// обновление заказа\r\nconst updateOrder = (state, bookId, quantity) => {\r\n  const { books, cartBooks } = state;\r\n  const book = books.find(book => book.id === bookId);\r\n  const cartItemIdx = cartBooks.findIndex(book => book.id === bookId);\r\n  const cartItem = cartBooks[cartItemIdx];\r\n  const newItem = updateCartItem(book, cartItem, quantity);\r\n  return {\r\n    ...state,\r\n    cartBooks: updateCartItems(cartBooks, newItem, cartItemIdx),\r\n  };\r\n};\r\n\r\nconst reducer = (state = defaultState, { type, payload }) => {\r\n  switch (type) {\r\n    // FETCH_..._REQUEST - name convention для получения данных с сервера\r\n    case 'FETCH_BOOKS_REQUEST':\r\n      return { ...state, books: [], loading: true, error: false };\r\n\r\n    // FETCH_..._SUCCESS - name convention для успешного сетевого запроса\r\n    case 'FETCH_BOOKS_SUCCESS':\r\n      return { ...state, books: payload, loading: false };\r\n\r\n    // FETCH_..._REQUEST - name convention для ошибки при выполнении сетевого запроса\r\n    case 'FETCH_BOOKS_FAILURE':\r\n      return { ...state, books: [], error: true };\r\n\r\n    // Добавление экземпляра книги к заказу\r\n    case 'BOOK_ADDED_TO_CART':\r\n      return updateOrder(state, payload, 1);\r\n\r\n    // Удаление экземпляра книги из заказа\r\n    case 'BOOK_REMOVED_FROM_CART':\r\n      return updateOrder(state, payload, -1);\r\n\r\n    // Полное удаление всех экземпляров книги из заказа\r\n    case 'ALL_BOOK_REMOVED_FROM_CART': {\r\n      const bookId = payload;\r\n      const cartItemIdx = state.cartBooks.findIndex(book => book.id === bookId);\r\n      const cartItem = state.cartBooks[cartItemIdx];\r\n      return updateOrder(state, payload, -cartItem.count);\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default reducer;\r\n","import { createStore, applyMiddleware, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport reduxLogger from 'redux-logger';\r\nimport reducer from './reducers';\r\n\r\nconst store = createStore(\r\n  reducer,\r\n  compose(\r\n    applyMiddleware(thunk, reduxLogger),\r\n    window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n  )\r\n);\r\n\r\nexport default store;\r\n","import React, { StrictMode } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider as ReduxProvider } from 'react-redux';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\n\r\nimport { BookStoreServiceProvider } from './components/BookStoreServiceContext';\r\nimport BookStoreService from './services/bookstore-service';\r\n\r\nimport App from './components/App';\r\nimport ErrorBoundry from './components/ErrorBoundry';\r\n\r\nimport store from './store';\r\n\r\nconst bookStoreService = new BookStoreService();\r\n\r\nReactDOM.render(\r\n  <StrictMode>\r\n    <ReduxProvider store={store}>\r\n      <ErrorBoundry>\r\n        <BookStoreServiceProvider value={bookStoreService}>\r\n          <Router>\r\n            <App />\r\n          </Router>\r\n        </BookStoreServiceProvider>\r\n      </ErrorBoundry>\r\n    </ReduxProvider>\r\n  </StrictMode>,\r\n  document.querySelector('.root')\r\n);\r\n"],"sourceRoot":""}